#+title: Tunnel Ttyd Tmux

* Install ttyd & tmux & wireguard-tools
Do this the usual way for your platform
* Run tmux and ttyd
Feel free to add a specific socket etc to tmux.
** tmux
Run it detached for now
#+begin_src shell
tmux -L ii new -d
#+end_src
** ttyd
The spawned shell should run *tmux at*
#+begin_src shell
ttyd -p 7681 tmux -L ii at
#+end_src
* Install tunnel
** needs go 1.20+
#+begin_src tmate :window tunnel
GO_VERSION=1.20.2
curl -sSL https://dl.google.com/go/go${GO_VERSION}.linux-amd64.tar.gz | sudo tar --directory /usr/local --extract --ungzip
#+end_src
https://github.com/coder/wgtunnel#usage
** And it needs to be in your path
#+begin_src tmate :window tunnel
export PATH=~/go/bin:/usr/local/go/bin:PATH
go install github.com/coder/wgtunnel/cmd/tunnel@v0.1.5
#+end_src
* Connect tunnel to ttyd
#+begin_src shell
export TUNNEL_WIREGUARD_KEY=$(wg genkey)
export TUNNEL_API_URL=http://try.ii.nz
~/go/bin/tunnel localhost:7681
#+end_src
